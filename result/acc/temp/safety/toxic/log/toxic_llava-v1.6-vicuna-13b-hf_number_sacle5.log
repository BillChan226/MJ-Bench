2024-05-30 22:52:49 | INFO | alignment_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 22:52:52 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:06,  1.21s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:04,  1.15s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:03<00:03,  1.13s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:04<00:02,  1.13s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:05<00:01,  1.13s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:06<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:06<00:00,  1.05s/it]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 22:52:59 | INFO | alignment_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/safety_single_number_scale5.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:16, 16.32s/it]Evaluating RM: : 2it [00:27, 13.16s/it]Evaluating RM: : 3it [00:34, 10.68s/it]Evaluating RM: : 4it [00:43,  9.84s/it]2024-05-30 22:53:57 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 4
Evaluating RM: : 5it [00:57, 11.31s/it]Evaluating RM: : 6it [01:06, 10.66s/it]Evaluating RM: : 7it [01:14,  9.59s/it]Evaluating RM: : 8it [01:23,  9.42s/it]Evaluating RM: : 9it [01:31,  9.14s/it]2024-05-30 22:54:40 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 9
Evaluating RM: : 10it [01:40,  8.93s/it]Evaluating RM: : 11it [01:51,  9.67s/it]Evaluating RM: : 12it [02:10, 12.36s/it]Evaluating RM: : 13it [02:19, 11.53s/it]Evaluating RM: : 14it [02:29, 11.05s/it]Evaluating RM: : 15it [02:39, 10.64s/it]Evaluating RM: : 16it [02:52, 11.30s/it]Evaluating RM: : 17it [03:02, 11.11s/it]Evaluating RM: : 18it [03:13, 10.90s/it]Evaluating RM: : 19it [03:21, 10.02s/it]Evaluating RM: : 20it [03:32, 10.52s/it]Evaluating RM: : 21it [03:40,  9.76s/it]Evaluating RM: : 22it [03:51, 10.10s/it]Evaluating RM: : 23it [03:59,  9.48s/it]Evaluating RM: : 24it [04:09,  9.50s/it]Evaluating RM: : 25it [04:17,  8.99s/it]Evaluating RM: : 26it [04:26,  9.08s/it]Evaluating RM: : 27it [04:37,  9.58s/it]Evaluating RM: : 28it [04:47,  9.86s/it]Evaluating RM: : 29it [04:57,  9.97s/it]2024-05-30 22:58:07 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 29
Evaluating RM: : 30it [05:07,  9.97s/it]Evaluating RM: : 31it [05:18, 10.14s/it]Evaluating RM: : 32it [05:29, 10.27s/it]Evaluating RM: : 33it [05:37,  9.79s/it]Evaluating RM: : 34it [05:45,  9.13s/it]Evaluating RM: : 35it [05:54,  9.14s/it]Evaluating RM: : 36it [06:03,  9.00s/it]Evaluating RM: : 37it [06:11,  8.74s/it]Evaluating RM: : 38it [06:25, 10.36s/it]Evaluating RM: : 39it [06:37, 10.95s/it]Evaluating RM: : 40it [06:47, 10.70s/it]Evaluating RM: : 41it [06:59, 11.12s/it]Evaluating RM: : 42it [07:06,  9.88s/it]Evaluating RM: : 43it [07:17, 10.02s/it]Evaluating RM: : 44it [07:28, 10.25s/it]Evaluating RM: : 45it [07:37, 10.13s/it]Evaluating RM: : 46it [07:46,  9.80s/it]Evaluating RM: : 47it [07:55,  9.53s/it]Evaluating RM: : 48it [08:06,  9.87s/it]Evaluating RM: : 49it [08:18, 10.45s/it]2024-05-30 23:01:27 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 49
Evaluating RM: : 50it [08:28, 10.26s/it]Evaluating RM: : 51it [08:35,  9.54s/it]Evaluating RM: : 52it [08:46,  9.92s/it]Evaluating RM: : 53it [09:07, 13.18s/it]Evaluating RM: : 54it [09:16, 11.86s/it]Evaluating RM: : 55it [09:28, 11.82s/it]2024-05-30 23:02:39 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 55
Evaluating RM: : 56it [09:40, 11.87s/it]Evaluating RM: : 57it [09:49, 11.22s/it]Evaluating RM: : 58it [09:59, 10.69s/it]Evaluating RM: : 59it [10:14, 12.15s/it]Evaluating RM: : 60it [10:27, 12.36s/it]Evaluating RM: : 61it [10:37, 11.58s/it]Evaluating RM: : 62it [10:48, 11.51s/it]Evaluating RM: : 63it [10:58, 11.05s/it]Evaluating RM: : 64it [11:12, 11.82s/it]Evaluating RM: : 65it [11:21, 10.93s/it]Evaluating RM: : 66it [11:30, 10.52s/it]Evaluating RM: : 67it [11:39, 10.06s/it]2024-05-30 23:04:52 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 67
Evaluating RM: : 68it [11:52, 10.83s/it]Evaluating RM: : 69it [12:03, 10.78s/it]Evaluating RM: : 70it [12:11,  9.96s/it]Evaluating RM: : 71it [12:19,  9.38s/it]Evaluating RM: : 72it [12:32, 10.61s/it]Evaluating RM: : 73it [12:41,  9.95s/it]Evaluating RM: : 74it [12:50,  9.75s/it]Evaluating RM: : 75it [12:59,  9.59s/it]Evaluating RM: : 76it [13:07,  9.06s/it]Evaluating RM: : 77it [13:16,  9.22s/it]Evaluating RM: : 78it [13:26,  9.41s/it]Evaluating RM: : 79it [13:37,  9.92s/it]Evaluating RM: : 80it [13:47,  9.69s/it]Evaluating RM: : 81it [14:00, 10.93s/it]Evaluating RM: : 82it [14:11, 10.87s/it]Evaluating RM: : 83it [14:19, 10.08s/it]Evaluating RM: : 84it [14:30, 10.27s/it]Evaluating RM: : 85it [14:40, 10.25s/it]Evaluating RM: : 86it [14:50, 10.12s/it]Evaluating RM: : 87it [15:03, 10.98s/it]Evaluating RM: : 88it [15:12, 10.23s/it]Evaluating RM: : 89it [15:25, 11.06s/it]Evaluating RM: : 90it [15:39, 12.06s/it]Evaluating RM: : 90it [15:39, 10.44s/it]
2024-05-30 23:08:39 | INFO | alignment_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/safety/toxic
