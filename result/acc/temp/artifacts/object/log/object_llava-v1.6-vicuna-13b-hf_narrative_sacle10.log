2024-05-30 22:18:55 | INFO | artifacte_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 22:18:58 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:04,  1.12it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.17it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.19it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.19it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.44it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.30it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 22:19:04 | INFO | artifacte_rm_score | Loading dataset from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/artifacts/objects_indoor...
2024-05-30 22:19:04 | INFO | artifacte_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/artifacts_single_narrative_scale10.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:11, 11.59s/it]Evaluating RM: : 2it [00:20, 10.31s/it]Evaluating RM: : 3it [00:30,  9.85s/it]Evaluating RM: : 4it [00:41, 10.40s/it]Evaluating RM: : 5it [00:52, 10.52s/it]Evaluating RM: : 6it [01:05, 11.36s/it]Evaluating RM: : 7it [01:20, 12.72s/it]Evaluating RM: : 8it [01:32, 12.27s/it]Evaluating RM: : 9it [01:41, 11.46s/it]Evaluating RM: : 10it [01:51, 10.80s/it]Evaluating RM: : 11it [02:03, 11.39s/it]Evaluating RM: : 12it [02:21, 13.33s/it]Evaluating RM: : 13it [02:33, 12.84s/it]Evaluating RM: : 14it [02:42, 11.67s/it]Evaluating RM: : 15it [02:55, 12.02s/it]Evaluating RM: : 16it [03:07, 12.21s/it]Evaluating RM: : 17it [03:19, 12.04s/it]Evaluating RM: : 18it [03:29, 11.44s/it]Evaluating RM: : 19it [03:40, 11.30s/it]Evaluating RM: : 20it [03:49, 10.78s/it]Evaluating RM: : 21it [04:02, 11.23s/it]Evaluating RM: : 22it [04:11, 10.70s/it]Evaluating RM: : 23it [04:22, 10.68s/it]Evaluating RM: : 24it [04:34, 11.12s/it]Evaluating RM: : 25it [04:44, 10.91s/it]Evaluating RM: : 26it [04:54, 10.52s/it]Evaluating RM: : 27it [05:04, 10.45s/it]Evaluating RM: : 28it [05:15, 10.64s/it]Evaluating RM: : 29it [05:31, 12.24s/it]Evaluating RM: : 30it [05:54, 15.39s/it]Evaluating RM: : 31it [06:01, 12.97s/it]Evaluating RM: : 32it [06:10, 11.73s/it]Evaluating RM: : 33it [06:25, 12.59s/it]Evaluating RM: : 34it [06:38, 12.66s/it]Evaluating RM: : 35it [06:48, 11.91s/it]Evaluating RM: : 36it [06:55, 10.45s/it]Evaluating RM: : 37it [07:07, 10.79s/it]Evaluating RM: : 38it [07:19, 11.17s/it]Evaluating RM: : 39it [07:28, 10.73s/it]Evaluating RM: : 40it [07:41, 11.46s/it]Evaluating RM: : 41it [07:54, 11.72s/it]Evaluating RM: : 42it [08:07, 12.23s/it]Evaluating RM: : 43it [08:18, 11.94s/it]Evaluating RM: : 44it [08:28, 11.27s/it]Evaluating RM: : 45it [08:40, 11.51s/it]Evaluating RM: : 46it [08:49, 10.67s/it]Evaluating RM: : 47it [09:00, 10.64s/it]Evaluating RM: : 48it [09:10, 10.51s/it]Evaluating RM: : 49it [09:21, 10.67s/it]Evaluating RM: : 50it [09:31, 10.64s/it]Evaluating RM: : 51it [09:43, 10.95s/it]Evaluating RM: : 52it [09:55, 11.41s/it]Evaluating RM: : 53it [10:05, 10.75s/it]Evaluating RM: : 54it [10:18, 11.60s/it]Evaluating RM: : 55it [10:28, 11.07s/it]Evaluating RM: : 56it [10:44, 12.59s/it]Evaluating RM: : 57it [10:56, 12.25s/it]Evaluating RM: : 58it [11:07, 11.87s/it]Evaluating RM: : 59it [11:17, 11.26s/it]Evaluating RM: : 60it [11:25, 10.45s/it]Evaluating RM: : 61it [11:34,  9.98s/it]Evaluating RM: : 62it [11:47, 10.77s/it]Evaluating RM: : 63it [11:57, 10.56s/it]Evaluating RM: : 64it [12:09, 11.12s/it]Evaluating RM: : 65it [12:22, 11.67s/it]Evaluating RM: : 66it [12:31, 10.75s/it]Evaluating RM: : 67it [12:47, 12.34s/it]Evaluating RM: : 68it [12:56, 11.39s/it]Evaluating RM: : 69it [13:10, 12.12s/it]Evaluating RM: : 70it [13:19, 11.37s/it]Evaluating RM: : 71it [13:32, 11.70s/it]Evaluating RM: : 72it [13:44, 11.95s/it]Evaluating RM: : 73it [13:58, 12.58s/it]Evaluating RM: : 74it [14:10, 12.31s/it]Evaluating RM: : 75it [14:23, 12.37s/it]Evaluating RM: : 76it [14:35, 12.34s/it]Evaluating RM: : 77it [14:47, 12.34s/it]Evaluating RM: : 78it [15:00, 12.61s/it]Evaluating RM: : 79it [15:10, 11.77s/it]Evaluating RM: : 80it [15:20, 11.12s/it]Evaluating RM: : 81it [15:29, 10.42s/it]Evaluating RM: : 82it [15:45, 12.11s/it]Evaluating RM: : 83it [15:54, 11.42s/it]Evaluating RM: : 84it [16:07, 11.84s/it]Evaluating RM: : 85it [16:18, 11.41s/it]Evaluating RM: : 86it [16:30, 11.77s/it]Evaluating RM: : 87it [16:41, 11.33s/it]Evaluating RM: : 88it [16:53, 11.61s/it]Evaluating RM: : 89it [17:06, 11.99s/it]Evaluating RM: : 90it [17:18, 12.04s/it]Evaluating RM: : 91it [17:27, 11.26s/it]Evaluating RM: : 92it [17:35, 10.06s/it]Evaluating RM: : 93it [17:47, 10.67s/it]Evaluating RM: : 94it [18:00, 11.51s/it]Evaluating RM: : 95it [18:17, 13.06s/it]Evaluating RM: : 96it [18:30, 13.20s/it]Evaluating RM: : 97it [18:41, 12.45s/it]Evaluating RM: : 98it [18:52, 11.90s/it]Evaluating RM: : 99it [19:01, 11.03s/it]Evaluating RM: : 100it [19:12, 11.26s/it]Evaluating RM: : 100it [19:12, 11.53s/it]
2024-05-30 22:38:17 | INFO | artifacte_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/artifacts/object
