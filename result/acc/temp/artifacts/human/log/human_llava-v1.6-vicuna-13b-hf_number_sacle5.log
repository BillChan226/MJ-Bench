2024-05-30 20:56:24 | INFO | artifacte_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 20:56:27 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.07s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:04,  1.01s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:03<00:03,  1.01s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:04<00:01,  1.00it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.11it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 20:56:33 | INFO | artifacte_rm_score | Loading dataset from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/artifacts/human...
2024-05-30 20:56:33 | INFO | artifacte_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/artifacts_single_number_scale5.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:11, 11.43s/it]2024-05-30 20:56:56 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 1
Evaluating RM: : 2it [00:23, 11.52s/it]2024-05-30 20:57:09 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 2
Evaluating RM: : 3it [00:35, 11.92s/it]Evaluating RM: : 4it [00:45, 11.34s/it]Evaluating RM: : 5it [00:55, 10.74s/it]Evaluating RM: : 6it [01:05, 10.44s/it]Evaluating RM: : 7it [01:17, 11.01s/it]Evaluating RM: : 8it [01:30, 11.63s/it]Evaluating RM: : 9it [01:41, 11.28s/it]2024-05-30 20:58:30 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 9
Evaluating RM: : 10it [01:56, 12.49s/it]Evaluating RM: : 11it [02:05, 11.42s/it]2024-05-30 20:59:00 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 11
Evaluating RM: : 12it [02:26, 14.47s/it]2024-05-30 20:59:13 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 12
Evaluating RM: : 13it [02:39, 14.10s/it]Evaluating RM: : 14it [02:49, 12.66s/it]Evaluating RM: : 15it [03:00, 12.24s/it]2024-05-30 20:59:48 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 15
Evaluating RM: : 16it [03:14, 12.86s/it]2024-05-30 20:59:59 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 16
Evaluating RM: : 17it [03:25, 12.25s/it]Evaluating RM: : 18it [03:35, 11.53s/it]2024-05-30 21:00:21 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 18
Evaluating RM: : 19it [03:48, 11.84s/it]2024-05-30 21:00:38 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 19
Evaluating RM: : 20it [04:04, 13.20s/it]Evaluating RM: : 21it [04:15, 12.40s/it]Evaluating RM: : 22it [04:23, 11.11s/it]2024-05-30 21:01:09 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 22
Evaluating RM: : 23it [04:36, 11.66s/it]2024-05-30 21:01:24 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 23
Evaluating RM: : 24it [04:50, 12.55s/it]Evaluating RM: : 25it [05:00, 11.66s/it]Evaluating RM: : 26it [05:09, 10.98s/it]2024-05-30 21:01:57 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 26
Evaluating RM: : 27it [05:23, 11.86s/it]Evaluating RM: : 28it [05:35, 11.96s/it]Evaluating RM: : 29it [05:44, 11.04s/it]Evaluating RM: : 30it [05:55, 11.11s/it]Evaluating RM: : 31it [06:07, 11.15s/it]2024-05-30 21:02:51 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 31
Evaluating RM: : 32it [06:17, 10.88s/it]Evaluating RM: : 33it [06:27, 10.51s/it]Evaluating RM: : 34it [06:35,  9.93s/it]Evaluating RM: : 35it [06:51, 11.78s/it]Evaluating RM: : 36it [07:00, 10.80s/it]Evaluating RM: : 37it [07:11, 11.07s/it]2024-05-30 21:03:57 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 37
Evaluating RM: : 38it [07:23, 11.15s/it]Evaluating RM: : 39it [07:32, 10.50s/it]Evaluating RM: : 40it [07:39,  9.57s/it]Evaluating RM: : 41it [07:51, 10.34s/it]Evaluating RM: : 42it [08:03, 10.77s/it]Evaluating RM: : 43it [08:17, 11.77s/it]Evaluating RM: : 44it [08:27, 11.26s/it]Evaluating RM: : 45it [08:35, 10.10s/it]Evaluating RM: : 46it [08:47, 10.76s/it]Evaluating RM: : 47it [08:56, 10.27s/it]Evaluating RM: : 48it [09:09, 11.04s/it]2024-05-30 21:05:55 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 48
Evaluating RM: : 49it [09:21, 11.46s/it]Evaluating RM: : 50it [09:29, 10.43s/it]Evaluating RM: : 51it [09:38,  9.87s/it]Evaluating RM: : 52it [09:49, 10.14s/it]Evaluating RM: : 53it [10:00, 10.59s/it]2024-05-30 21:06:50 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 53
Evaluating RM: : 54it [10:16, 12.04s/it]Evaluating RM: : 55it [10:28, 12.06s/it]Evaluating RM: : 56it [10:38, 11.35s/it]Evaluating RM: : 57it [10:47, 10.80s/it]Evaluating RM: : 58it [11:02, 12.08s/it]Evaluating RM: : 59it [11:23, 14.75s/it]Evaluating RM: : 60it [11:32, 13.03s/it]Evaluating RM: : 61it [11:42, 12.21s/it]2024-05-30 21:08:29 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 61
Evaluating RM: : 62it [11:55, 12.26s/it]Evaluating RM: : 63it [12:03, 11.09s/it]Evaluating RM: : 64it [12:15, 11.28s/it]Evaluating RM: : 65it [12:36, 14.10s/it]Evaluating RM: : 66it [12:46, 13.00s/it]Evaluating RM: : 67it [13:04, 14.35s/it]Evaluating RM: : 68it [13:15, 13.40s/it]2024-05-30 21:10:00 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 68
Evaluating RM: : 69it [13:26, 12.77s/it]Evaluating RM: : 70it [13:35, 11.59s/it]Evaluating RM: : 71it [13:52, 13.24s/it]2024-05-30 21:10:40 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 71
Evaluating RM: : 72it [14:06, 13.47s/it]2024-05-30 21:10:49 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 72
Evaluating RM: : 73it [14:15, 12.09s/it]2024-05-30 21:10:59 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 73
Evaluating RM: : 74it [14:26, 11.69s/it]Evaluating RM: : 75it [14:35, 11.09s/it]2024-05-30 21:11:23 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 75
Evaluating RM: : 76it [14:50, 12.08s/it]Evaluating RM: : 77it [14:59, 11.22s/it]2024-05-30 21:11:46 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 77
Evaluating RM: : 78it [15:12, 11.79s/it]2024-05-30 21:11:56 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 78
Evaluating RM: : 79it [15:23, 11.45s/it]2024-05-30 21:12:09 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 79
Evaluating RM: : 80it [15:35, 11.79s/it]Evaluating RM: : 81it [15:48, 11.97s/it]Evaluating RM: : 82it [15:56, 10.99s/it]Evaluating RM: : 83it [16:06, 10.68s/it]Evaluating RM: : 84it [16:16, 10.34s/it]Evaluating RM: : 85it [16:25, 10.01s/it]2024-05-30 21:13:12 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 85
Evaluating RM: : 86it [16:38, 10.81s/it]2024-05-30 21:13:22 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 86
Evaluating RM: : 87it [16:48, 10.69s/it]Evaluating RM: : 88it [16:57, 10.00s/it]Evaluating RM: : 89it [17:07, 10.12s/it]Evaluating RM: : 90it [17:16,  9.72s/it]Evaluating RM: : 91it [17:27, 10.25s/it]2024-05-30 21:14:11 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 91
Evaluating RM: : 92it [17:37, 10.26s/it]Evaluating RM: : 93it [17:45,  9.37s/it]2024-05-30 21:14:33 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 93
Evaluating RM: : 94it [17:59, 10.75s/it]Evaluating RM: : 95it [18:08, 10.30s/it]Evaluating RM: : 96it [18:23, 11.84s/it]2024-05-30 21:15:09 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 96
Evaluating RM: : 97it [18:35, 11.73s/it]Evaluating RM: : 98it [18:44, 10.96s/it]2024-05-30 21:15:33 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 98
Evaluating RM: : 99it [18:59, 12.08s/it]Evaluating RM: : 100it [19:11, 11.99s/it]Evaluating RM: : 100it [19:11, 11.51s/it]
2024-05-30 21:15:44 | INFO | artifacte_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/artifacts/human
