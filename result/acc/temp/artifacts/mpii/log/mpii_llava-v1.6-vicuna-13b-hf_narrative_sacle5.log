2024-05-31 00:07:07 | INFO | artifacte_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-31 00:07:10 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:04,  1.11it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.17it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.20it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.20it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.22it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.31it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-31 00:07:15 | INFO | artifacte_rm_score | Loading dataset from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/artifacts/mpii...
2024-05-31 00:07:15 | INFO | artifacte_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/artifacts_single_narrative_scale5.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:12, 12.23s/it]Evaluating RM: : 2it [00:20, 10.19s/it]Evaluating RM: : 3it [00:31, 10.20s/it]Evaluating RM: : 4it [00:40,  9.95s/it]Evaluating RM: : 5it [00:53, 11.08s/it]Evaluating RM: : 6it [01:01,  9.83s/it]Evaluating RM: : 7it [01:08,  8.92s/it]Evaluating RM: : 8it [01:18,  9.41s/it]Evaluating RM: : 9it [01:25,  8.43s/it]Evaluating RM: : 10it [01:36,  9.46s/it]Evaluating RM: : 11it [01:47,  9.69s/it]Evaluating RM: : 12it [01:54,  9.17s/it]Evaluating RM: : 13it [02:02,  8.67s/it]Evaluating RM: : 14it [02:11,  8.77s/it]Evaluating RM: : 15it [02:18,  8.31s/it]Evaluating RM: : 16it [02:26,  8.08s/it]Evaluating RM: : 17it [02:33,  7.90s/it]Evaluating RM: : 18it [02:43,  8.54s/it]Evaluating RM: : 19it [02:52,  8.69s/it]Evaluating RM: : 20it [03:04,  9.47s/it]Evaluating RM: : 21it [03:12,  9.28s/it]Evaluating RM: : 22it [03:21,  9.01s/it]Evaluating RM: : 23it [03:30,  9.03s/it]Evaluating RM: : 24it [03:41,  9.52s/it]Evaluating RM: : 25it [03:47,  8.73s/it]Evaluating RM: : 26it [03:59,  9.48s/it]Evaluating RM: : 27it [04:08,  9.36s/it]Evaluating RM: : 28it [04:17,  9.27s/it]Evaluating RM: : 29it [04:26,  9.23s/it]2024-05-31 00:11:51 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 29
Evaluating RM: : 30it [04:35,  9.07s/it]Evaluating RM: : 31it [04:50, 11.09s/it]Evaluating RM: : 32it [05:00, 10.61s/it]Evaluating RM: : 33it [05:09, 10.17s/it]2024-05-31 00:12:39 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 33
Evaluating RM: : 34it [05:23, 11.23s/it]Evaluating RM: : 35it [05:32, 10.59s/it]Evaluating RM: : 36it [05:41, 10.14s/it]Evaluating RM: : 37it [05:48,  9.33s/it]Evaluating RM: : 38it [05:57,  9.20s/it]Evaluating RM: : 39it [06:04,  8.35s/it]2024-05-31 00:13:32 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 39
Evaluating RM: : 40it [06:16,  9.53s/it]Evaluating RM: : 41it [06:24,  9.19s/it]Evaluating RM: : 42it [06:32,  8.81s/it]Evaluating RM: : 43it [06:41,  8.91s/it]Evaluating RM: : 44it [06:53,  9.74s/it]2024-05-31 00:14:17 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 44
Evaluating RM: : 45it [07:01,  9.30s/it]Evaluating RM: : 46it [07:15, 10.68s/it]Evaluating RM: : 47it [07:24, 10.21s/it]Evaluating RM: : 48it [07:35, 10.24s/it]Evaluating RM: : 49it [07:44, 10.09s/it]Evaluating RM: : 50it [07:51,  9.06s/it]Evaluating RM: : 51it [08:01,  9.35s/it]Evaluating RM: : 52it [08:14, 10.26s/it]Evaluating RM: : 53it [08:23, 10.08s/it]Evaluating RM: : 54it [08:34, 10.38s/it]Evaluating RM: : 55it [08:44, 10.24s/it]Evaluating RM: : 56it [08:56, 10.61s/it]Evaluating RM: : 57it [09:04, 10.08s/it]Evaluating RM: : 58it [09:12,  9.39s/it]Evaluating RM: : 59it [09:21,  9.19s/it]Evaluating RM: : 60it [09:31,  9.52s/it]Evaluating RM: : 61it [09:40,  9.25s/it]Evaluating RM: : 62it [09:51,  9.75s/it]Evaluating RM: : 63it [10:01,  9.99s/it]Evaluating RM: : 64it [10:09,  9.21s/it]2024-05-31 00:17:39 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 64
Evaluating RM: : 65it [10:23, 10.66s/it]Evaluating RM: : 66it [10:31,  9.79s/it]Evaluating RM: : 67it [10:38,  9.18s/it]Evaluating RM: : 68it [10:47,  8.89s/it]Evaluating RM: : 69it [10:55,  8.90s/it]Evaluating RM: : 70it [11:04,  8.87s/it]Evaluating RM: : 71it [11:15,  9.46s/it]Evaluating RM: : 72it [11:24,  9.36s/it]Evaluating RM: : 73it [11:32,  8.91s/it]Evaluating RM: : 74it [11:41,  8.90s/it]Evaluating RM: : 75it [11:49,  8.50s/it]Evaluating RM: : 76it [11:58,  8.78s/it]Evaluating RM: : 77it [12:05,  8.18s/it]Evaluating RM: : 78it [12:17,  9.28s/it]Evaluating RM: : 79it [12:24,  8.61s/it]Evaluating RM: : 80it [12:35,  9.40s/it]Evaluating RM: : 81it [12:47, 10.34s/it]Evaluating RM: : 82it [12:58, 10.37s/it]Evaluating RM: : 83it [13:08, 10.44s/it]Evaluating RM: : 84it [13:19, 10.37s/it]Evaluating RM: : 85it [13:27,  9.83s/it]Evaluating RM: : 86it [13:37,  9.89s/it]2024-05-31 00:21:10 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 86
Evaluating RM: : 87it [13:54, 11.86s/it]Evaluating RM: : 88it [14:05, 11.70s/it]Evaluating RM: : 89it [14:14, 10.97s/it]Evaluating RM: : 90it [14:23, 10.25s/it]Evaluating RM: : 91it [14:31,  9.69s/it]Evaluating RM: : 92it [14:42,  9.88s/it]Evaluating RM: : 93it [14:52,  9.96s/it]Evaluating RM: : 94it [15:01,  9.73s/it]Evaluating RM: : 95it [15:07,  8.73s/it]Evaluating RM: : 96it [15:16,  8.75s/it]Evaluating RM: : 97it [15:24,  8.43s/it]Evaluating RM: : 98it [15:35,  9.27s/it]Evaluating RM: : 99it [15:47, 10.10s/it]Evaluating RM: : 100it [15:57,  9.99s/it]Evaluating RM: : 101it [16:05,  9.52s/it]Evaluating RM: : 102it [16:13,  8.99s/it]Evaluating RM: : 103it [16:29, 11.14s/it]Evaluating RM: : 104it [16:40, 10.96s/it]Evaluating RM: : 105it [16:53, 11.57s/it]Evaluating RM: : 106it [16:59, 10.06s/it]Evaluating RM: : 107it [17:05,  8.82s/it]Evaluating RM: : 108it [17:14,  8.91s/it]Evaluating RM: : 109it [17:20,  8.06s/it]2024-05-31 00:24:47 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 109
Evaluating RM: : 110it [17:31,  8.99s/it]Evaluating RM: : 111it [17:39,  8.45s/it]Evaluating RM: : 112it [17:52, 10.04s/it]Evaluating RM: : 113it [18:05, 10.90s/it]Evaluating RM: : 114it [18:13,  9.99s/it]2024-05-31 00:25:43 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 114
Evaluating RM: : 115it [18:27, 11.17s/it]Evaluating RM: : 116it [18:34,  9.88s/it]Evaluating RM: : 117it [18:41,  8.88s/it]2024-05-31 00:26:08 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 117
Evaluating RM: : 118it [18:52,  9.52s/it]Evaluating RM: : 119it [19:01,  9.54s/it]Evaluating RM: : 120it [19:09,  8.90s/it]Evaluating RM: : 121it [19:20,  9.60s/it]Evaluating RM: : 122it [19:29,  9.41s/it]Evaluating RM: : 123it [19:38,  9.51s/it]Evaluating RM: : 124it [19:45,  8.62s/it]Evaluating RM: : 125it [19:54,  8.70s/it]Evaluating RM: : 126it [20:03,  8.87s/it]Evaluating RM: : 127it [20:12,  8.91s/it]Evaluating RM: : 128it [20:25, 10.13s/it]Evaluating RM: : 129it [20:36, 10.24s/it]Evaluating RM: : 130it [20:44,  9.78s/it]Evaluating RM: : 131it [20:53,  9.37s/it]Evaluating RM: : 132it [21:02,  9.46s/it]Evaluating RM: : 133it [21:10,  8.90s/it]Evaluating RM: : 134it [21:22,  9.71s/it]Evaluating RM: : 135it [21:32,  9.97s/it]Evaluating RM: : 136it [21:40,  9.44s/it]Evaluating RM: : 137it [21:50,  9.43s/it]Evaluating RM: : 138it [21:59,  9.22s/it]Evaluating RM: : 139it [22:09,  9.66s/it]Evaluating RM: : 140it [22:16,  8.72s/it]Evaluating RM: : 141it [22:26,  9.20s/it]Evaluating RM: : 142it [22:36,  9.29s/it]Evaluating RM: : 143it [22:46,  9.52s/it]Evaluating RM: : 144it [22:55,  9.58s/it]Evaluating RM: : 145it [23:01,  8.32s/it]Evaluating RM: : 146it [23:12,  9.17s/it]Evaluating RM: : 147it [23:24,  9.96s/it]Evaluating RM: : 148it [23:35, 10.44s/it]Evaluating RM: : 149it [23:43,  9.64s/it]Evaluating RM: : 150it [23:52,  9.50s/it]Evaluating RM: : 151it [24:00,  9.02s/it]Evaluating RM: : 152it [24:08,  8.56s/it]Evaluating RM: : 153it [24:17,  8.79s/it]Evaluating RM: : 154it [24:25,  8.70s/it]Evaluating RM: : 155it [24:31,  7.90s/it]2024-05-31 00:31:58 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 155
Evaluating RM: : 156it [24:42,  8.63s/it]Evaluating RM: : 157it [24:51,  8.71s/it]Evaluating RM: : 158it [25:02,  9.42s/it]2024-05-31 00:32:28 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 158
Evaluating RM: : 159it [25:12,  9.76s/it]Evaluating RM: : 160it [25:21,  9.54s/it]2024-05-31 00:32:49 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 160
Evaluating RM: : 161it [25:33, 10.05s/it]Evaluating RM: : 162it [25:38,  8.80s/it]Evaluating RM: : 163it [25:47,  8.65s/it]Evaluating RM: : 164it [25:57,  9.26s/it]Evaluating RM: : 165it [26:06,  9.18s/it]Evaluating RM: : 166it [26:17,  9.47s/it]Evaluating RM: : 167it [26:27,  9.75s/it]2024-05-31 00:33:54 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 167
Evaluating RM: : 168it [26:38, 10.00s/it]Evaluating RM: : 169it [26:45,  9.26s/it]Evaluating RM: : 170it [26:54,  9.13s/it]Evaluating RM: : 171it [27:07, 10.22s/it]Evaluating RM: : 172it [27:13,  9.08s/it]Evaluating RM: : 173it [27:26, 10.20s/it]Evaluating RM: : 174it [27:36, 10.11s/it]Evaluating RM: : 175it [27:45,  9.86s/it]2024-05-31 00:35:14 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 175
Evaluating RM: : 176it [27:58, 10.74s/it]Evaluating RM: : 177it [28:09, 10.76s/it]Evaluating RM: : 178it [28:14,  9.20s/it]Evaluating RM: : 179it [28:21,  8.55s/it]Evaluating RM: : 180it [28:31,  8.82s/it]Evaluating RM: : 181it [28:39,  8.60s/it]Evaluating RM: : 182it [28:44,  7.69s/it]Evaluating RM: : 183it [28:52,  7.55s/it]Evaluating RM: : 184it [29:00,  7.88s/it]Evaluating RM: : 185it [29:09,  8.05s/it]Evaluating RM: : 186it [29:20,  8.93s/it]Evaluating RM: : 187it [29:32, 10.03s/it]Evaluating RM: : 188it [29:43, 10.37s/it]Evaluating RM: : 189it [29:53, 10.20s/it]Evaluating RM: : 190it [30:02,  9.66s/it]2024-05-31 00:37:31 | INFO | artifacte_rm_score | Cannot parsing the score from vlm output. sample id is 190
Evaluating RM: : 191it [30:15, 10.77s/it]Evaluating RM: : 192it [30:25, 10.38s/it]Evaluating RM: : 193it [30:34, 10.03s/it]Evaluating RM: : 194it [30:41,  9.21s/it]Evaluating RM: : 195it [30:51,  9.52s/it]Evaluating RM: : 196it [30:59,  9.11s/it]Evaluating RM: : 197it [31:08,  8.92s/it]Evaluating RM: : 198it [31:17,  9.03s/it]Evaluating RM: : 199it [31:29,  9.87s/it]Evaluating RM: : 200it [31:38,  9.74s/it]Evaluating RM: : 201it [31:53, 11.04s/it]Evaluating RM: : 202it [32:00,  9.89s/it]Evaluating RM: : 203it [32:09,  9.68s/it]Evaluating RM: : 204it [32:19,  9.73s/it]Evaluating RM: : 205it [32:28,  9.51s/it]Evaluating RM: : 206it [32:38,  9.78s/it]Evaluating RM: : 207it [32:47,  9.53s/it]Evaluating RM: : 208it [32:55,  8.91s/it]Evaluating RM: : 209it [33:04,  9.11s/it]Evaluating RM: : 210it [33:11,  8.35s/it]Evaluating RM: : 211it [33:20,  8.54s/it]Evaluating RM: : 212it [33:26,  7.95s/it]Evaluating RM: : 213it [33:37,  8.90s/it]Evaluating RM: : 214it [33:49,  9.85s/it]Evaluating RM: : 215it [33:58,  9.51s/it]Evaluating RM: : 216it [34:10, 10.22s/it]Evaluating RM: : 217it [34:20, 10.20s/it]Evaluating RM: : 218it [34:31, 10.33s/it]Evaluating RM: : 219it [34:38,  9.42s/it]Evaluating RM: : 220it [34:44,  8.33s/it]Evaluating RM: : 220it [34:44,  9.47s/it]
2024-05-31 00:42:00 | INFO | artifacte_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/artifacts/mpii
