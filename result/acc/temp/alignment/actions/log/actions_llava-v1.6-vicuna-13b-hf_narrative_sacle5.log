2024-05-30 20:30:12 | INFO | alignment_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 20:30:16 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:04,  1.08it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.11it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.11it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.10it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.10it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.35it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.21it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 20:30:22 | INFO | alignment_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/alignment_single_narrative_scale5.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:13, 13.84s/it]Evaluating RM: : 2it [00:25, 12.41s/it]Evaluating RM: : 3it [00:39, 13.46s/it]Evaluating RM: : 4it [00:51, 12.57s/it]Evaluating RM: : 5it [01:15, 16.70s/it]Evaluating RM: : 6it [01:25, 14.36s/it]Evaluating RM: : 7it [01:39, 14.50s/it]Evaluating RM: : 8it [01:51, 13.48s/it]Evaluating RM: : 9it [02:01, 12.56s/it]Evaluating RM: : 10it [02:12, 11.92s/it]Evaluating RM: : 11it [02:24, 12.20s/it]Evaluating RM: : 12it [02:41, 13.51s/it]Evaluating RM: : 13it [03:11, 18.54s/it]Evaluating RM: : 14it [03:25, 17.07s/it]Evaluating RM: : 15it [03:46, 18.25s/it]Evaluating RM: : 16it [04:05, 18.66s/it]Evaluating RM: : 17it [04:20, 17.33s/it]Evaluating RM: : 18it [04:40, 18.21s/it]2024-05-30 20:35:22 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 18
Evaluating RM: : 19it [05:00, 18.88s/it]Evaluating RM: : 20it [05:13, 16.90s/it]Evaluating RM: : 21it [05:21, 14.50s/it]Evaluating RM: : 22it [05:34, 13.88s/it]Evaluating RM: : 23it [05:46, 13.50s/it]Evaluating RM: : 24it [06:01, 13.67s/it]Evaluating RM: : 25it [06:16, 14.21s/it]Evaluating RM: : 26it [06:29, 13.77s/it]Evaluating RM: : 27it [06:46, 14.91s/it]Evaluating RM: : 28it [07:00, 14.58s/it]Evaluating RM: : 29it [07:18, 15.70s/it]Evaluating RM: : 30it [07:39, 17.26s/it]Evaluating RM: : 31it [07:52, 15.78s/it]Evaluating RM: : 32it [08:07, 15.69s/it]Evaluating RM: : 33it [08:29, 17.49s/it]Evaluating RM: : 34it [08:50, 18.71s/it]Evaluating RM: : 35it [09:10, 18.96s/it]Evaluating RM: : 36it [09:26, 17.94s/it]Evaluating RM: : 37it [09:37, 15.93s/it]Evaluating RM: : 38it [09:46, 13.78s/it]Evaluating RM: : 39it [09:55, 12.57s/it]Evaluating RM: : 40it [10:08, 12.60s/it]Evaluating RM: : 41it [10:20, 12.31s/it]Evaluating RM: : 42it [10:29, 11.53s/it]Evaluating RM: : 43it [10:40, 11.37s/it]Evaluating RM: : 44it [10:52, 11.55s/it]Evaluating RM: : 45it [11:09, 13.00s/it]Evaluating RM: : 46it [11:21, 12.93s/it]Evaluating RM: : 47it [11:36, 13.32s/it]Evaluating RM: : 48it [11:47, 12.69s/it]Evaluating RM: : 49it [12:01, 13.19s/it]Evaluating RM: : 50it [12:18, 14.20s/it]Evaluating RM: : 51it [12:36, 15.54s/it]Evaluating RM: : 52it [12:49, 14.57s/it]Evaluating RM: : 53it [13:17, 18.80s/it]Evaluating RM: : 54it [13:36, 18.61s/it]Evaluating RM: : 55it [13:45, 15.91s/it]Evaluating RM: : 56it [13:52, 13.22s/it]Evaluating RM: : 57it [14:13, 15.66s/it]Evaluating RM: : 58it [14:41, 19.07s/it]Evaluating RM: : 59it [14:45, 14.84s/it]2024-05-30 20:45:25 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 59
Evaluating RM: : 60it [15:03, 15.67s/it]Evaluating RM: : 61it [15:19, 15.68s/it]Evaluating RM: : 62it [15:30, 14.23s/it]Evaluating RM: : 63it [15:40, 13.18s/it]2024-05-30 20:46:19 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 63
Evaluating RM: : 64it [15:57, 14.08s/it]2024-05-30 20:46:33 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 64
Evaluating RM: : 65it [16:11, 14.21s/it]Evaluating RM: : 66it [16:24, 13.91s/it]Evaluating RM: : 67it [16:41, 14.85s/it]Evaluating RM: : 68it [16:58, 15.34s/it]2024-05-30 20:47:47 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 68
Evaluating RM: : 69it [17:25, 18.78s/it]Evaluating RM: : 70it [17:33, 15.64s/it]Evaluating RM: : 71it [17:46, 14.83s/it]Evaluating RM: : 72it [17:59, 14.31s/it]Evaluating RM: : 73it [18:11, 13.53s/it]Evaluating RM: : 74it [18:25, 13.85s/it]Evaluating RM: : 75it [18:36, 12.85s/it]Evaluating RM: : 76it [18:51, 13.64s/it]Evaluating RM: : 77it [19:06, 14.01s/it]Evaluating RM: : 78it [19:24, 15.12s/it]Evaluating RM: : 79it [19:39, 15.09s/it]Evaluating RM: : 80it [19:56, 15.80s/it]Evaluating RM: : 81it [20:08, 14.43s/it]Evaluating RM: : 82it [20:20, 13.71s/it]Evaluating RM: : 83it [20:30, 12.58s/it]Evaluating RM: : 84it [20:38, 11.36s/it]Evaluating RM: : 85it [20:50, 11.49s/it]Evaluating RM: : 86it [21:03, 11.94s/it]Evaluating RM: : 87it [21:17, 12.65s/it]Evaluating RM: : 88it [21:30, 12.77s/it]Evaluating RM: : 89it [21:40, 11.99s/it]Evaluating RM: : 90it [21:56, 13.14s/it]Evaluating RM: : 91it [22:15, 14.88s/it]Evaluating RM: : 92it [22:25, 13.37s/it]2024-05-30 20:53:13 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 92
Evaluating RM: : 93it [22:51, 17.26s/it]Evaluating RM: : 94it [23:07, 16.68s/it]Evaluating RM: : 95it [23:27, 17.66s/it]Evaluating RM: : 96it [23:39, 16.14s/it]Evaluating RM: : 97it [23:51, 14.89s/it]Evaluating RM: : 98it [24:06, 14.83s/it]Evaluating RM: : 99it [24:15, 13.21s/it]Evaluating RM: : 100it [24:33, 14.68s/it]Evaluating RM: : 101it [24:43, 13.26s/it]Evaluating RM: : 102it [24:54, 12.60s/it]Evaluating RM: : 103it [25:05, 12.07s/it]Evaluating RM: : 104it [25:18, 12.16s/it]Evaluating RM: : 105it [25:31, 12.69s/it]Evaluating RM: : 106it [25:49, 14.07s/it]Evaluating RM: : 107it [26:02, 13.70s/it]Evaluating RM: : 108it [26:14, 13.40s/it]Evaluating RM: : 109it [26:33, 15.08s/it]Evaluating RM: : 110it [26:51, 15.86s/it]Evaluating RM: : 111it [27:05, 15.43s/it]Evaluating RM: : 112it [27:24, 16.39s/it]Evaluating RM: : 113it [27:42, 16.78s/it]Evaluating RM: : 114it [27:53, 14.97s/it]Evaluating RM: : 115it [28:11, 16.08s/it]Evaluating RM: : 116it [28:21, 14.23s/it]Evaluating RM: : 117it [28:33, 13.63s/it]Evaluating RM: : 117it [28:33, 14.65s/it]
2024-05-30 20:58:55 | INFO | alignment_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/alignment/actions
