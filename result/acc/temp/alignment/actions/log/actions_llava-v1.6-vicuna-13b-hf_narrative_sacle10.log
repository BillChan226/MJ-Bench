2024-05-30 20:37:43 | INFO | alignment_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 20:37:47 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.01s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.09it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.09it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.07it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.30it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.17it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 20:37:53 | INFO | alignment_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/alignment_single_narrative_scale10.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:17, 17.37s/it]Evaluating RM: : 2it [00:27, 13.20s/it]Evaluating RM: : 3it [00:42, 13.77s/it]Evaluating RM: : 4it [00:58, 14.65s/it]Evaluating RM: : 5it [01:23, 18.36s/it]Evaluating RM: : 6it [01:39, 17.75s/it]Evaluating RM: : 7it [01:50, 15.65s/it]Evaluating RM: : 8it [02:05, 15.27s/it]Evaluating RM: : 9it [02:16, 14.10s/it]Evaluating RM: : 10it [02:29, 13.69s/it]2024-05-30 20:40:36 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 10
Evaluating RM: : 11it [02:42, 13.49s/it]Evaluating RM: : 12it [03:02, 15.46s/it]2024-05-30 20:41:20 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 12
Evaluating RM: : 13it [03:26, 18.13s/it]Evaluating RM: : 14it [03:38, 16.20s/it]Evaluating RM: : 15it [04:01, 18.19s/it]Evaluating RM: : 16it [04:14, 16.68s/it]Evaluating RM: : 17it [04:25, 14.90s/it]Evaluating RM: : 18it [04:40, 14.87s/it]Evaluating RM: : 19it [04:52, 14.13s/it]Evaluating RM: : 20it [05:08, 14.58s/it]Evaluating RM: : 21it [05:18, 13.15s/it]Evaluating RM: : 22it [05:29, 12.53s/it]Evaluating RM: : 23it [05:41, 12.36s/it]Evaluating RM: : 24it [05:56, 13.19s/it]Evaluating RM: : 25it [06:13, 14.54s/it]Evaluating RM: : 26it [06:31, 15.35s/it]Evaluating RM: : 27it [06:47, 15.76s/it]Evaluating RM: : 28it [07:06, 16.64s/it]Evaluating RM: : 29it [07:27, 18.00s/it]Evaluating RM: : 30it [07:48, 18.84s/it]Evaluating RM: : 31it [07:59, 16.53s/it]2024-05-30 20:46:05 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 31
Evaluating RM: : 32it [08:12, 15.28s/it]Evaluating RM: : 33it [08:39, 19.03s/it]Evaluating RM: : 34it [08:56, 18.40s/it]Evaluating RM: : 35it [09:19, 19.67s/it]Evaluating RM: : 36it [09:32, 17.84s/it]Evaluating RM: : 37it [09:51, 18.03s/it]Evaluating RM: : 38it [10:00, 15.40s/it]Evaluating RM: : 39it [10:10, 13.84s/it]Evaluating RM: : 40it [10:23, 13.53s/it]Evaluating RM: : 41it [10:35, 12.92s/it]Evaluating RM: : 42it [10:53, 14.41s/it]Evaluating RM: : 43it [11:04, 13.45s/it]Evaluating RM: : 44it [11:15, 12.89s/it]Evaluating RM: : 45it [11:27, 12.41s/it]Evaluating RM: : 46it [11:36, 11.62s/it]Evaluating RM: : 47it [11:50, 12.15s/it]Evaluating RM: : 48it [12:06, 13.20s/it]Evaluating RM: : 49it [12:23, 14.47s/it]Evaluating RM: : 50it [12:33, 13.26s/it]Evaluating RM: : 51it [12:47, 13.39s/it]Evaluating RM: : 52it [12:58, 12.72s/it]Evaluating RM: : 53it [13:24, 16.59s/it]Evaluating RM: : 54it [13:38, 15.76s/it]2024-05-30 20:51:43 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 54
Evaluating RM: : 55it [13:49, 14.51s/it]Evaluating RM: : 56it [14:06, 15.16s/it]Evaluating RM: : 57it [14:24, 15.97s/it]2024-05-30 20:52:43 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 57
Evaluating RM: : 58it [14:49, 18.86s/it]Evaluating RM: : 59it [14:58, 15.83s/it]2024-05-30 20:53:10 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 59
Evaluating RM: : 60it [15:17, 16.64s/it]Evaluating RM: : 61it [15:37, 17.77s/it]2024-05-30 20:53:47 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 61
Evaluating RM: : 62it [15:53, 17.25s/it]2024-05-30 20:54:14 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 62
Evaluating RM: : 63it [16:21, 20.35s/it]Evaluating RM: : 64it [16:32, 17.71s/it]Evaluating RM: : 65it [16:44, 16.00s/it]Evaluating RM: : 66it [17:03, 16.84s/it]Evaluating RM: : 67it [17:22, 17.58s/it]Evaluating RM: : 68it [17:32, 15.28s/it]2024-05-30 20:55:57 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 68
Evaluating RM: : 69it [18:03, 19.94s/it]Evaluating RM: : 70it [18:12, 16.64s/it]Evaluating RM: : 71it [18:24, 15.21s/it]Evaluating RM: : 72it [18:39, 15.25s/it]Evaluating RM: : 73it [18:51, 14.15s/it]Evaluating RM: : 74it [19:08, 14.90s/it]Evaluating RM: : 75it [19:19, 13.75s/it]Evaluating RM: : 76it [19:36, 14.98s/it]Evaluating RM: : 77it [19:48, 13.82s/it]Evaluating RM: : 78it [20:11, 16.62s/it]2024-05-30 20:58:30 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 78
Evaluating RM: : 79it [20:37, 19.47s/it]Evaluating RM: : 80it [20:47, 16.56s/it]Evaluating RM: : 81it [21:00, 15.67s/it]Evaluating RM: : 82it [21:13, 14.83s/it]Evaluating RM: : 83it [21:23, 13.51s/it]Evaluating RM: : 84it [21:33, 12.41s/it]Evaluating RM: : 85it [21:46, 12.60s/it]Evaluating RM: : 86it [21:58, 12.24s/it]Evaluating RM: : 87it [22:07, 11.38s/it]Evaluating RM: : 88it [22:19, 11.62s/it]Evaluating RM: : 89it [22:30, 11.36s/it]Evaluating RM: : 90it [22:42, 11.63s/it]Evaluating RM: : 91it [23:06, 15.16s/it]Evaluating RM: : 92it [23:16, 13.78s/it]Evaluating RM: : 93it [23:39, 16.37s/it]Evaluating RM: : 94it [23:52, 15.39s/it]Evaluating RM: : 95it [24:03, 14.25s/it]Evaluating RM: : 96it [24:22, 15.65s/it]Evaluating RM: : 97it [24:41, 16.55s/it]Evaluating RM: : 98it [24:57, 16.40s/it]Evaluating RM: : 99it [25:08, 14.75s/it]Evaluating RM: : 100it [25:26, 15.64s/it]Evaluating RM: : 101it [25:38, 14.56s/it]Evaluating RM: : 102it [25:50, 13.83s/it]Evaluating RM: : 103it [26:07, 14.90s/it]Evaluating RM: : 104it [26:21, 14.71s/it]Evaluating RM: : 105it [26:32, 13.45s/it]Evaluating RM: : 106it [26:44, 13.13s/it]Evaluating RM: : 107it [26:58, 13.20s/it]Evaluating RM: : 108it [27:08, 12.25s/it]Evaluating RM: : 109it [27:26, 14.09s/it]Evaluating RM: : 110it [27:40, 14.07s/it]Evaluating RM: : 111it [27:50, 12.78s/it]Evaluating RM: : 112it [28:09, 14.51s/it]Evaluating RM: : 113it [28:28, 16.03s/it]Evaluating RM: : 114it [28:36, 13.50s/it]Evaluating RM: : 115it [28:46, 12.57s/it]Evaluating RM: : 116it [29:16, 17.84s/it]Evaluating RM: : 117it [29:29, 16.20s/it]Evaluating RM: : 117it [29:29, 15.12s/it]
2024-05-30 21:07:22 | INFO | alignment_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/alignment/actions
