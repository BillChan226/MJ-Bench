2024-05-30 22:53:07 | INFO | alignment_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 22:53:10 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:04,  1.12it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.15it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.20it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.24it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.34it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 22:53:15 | INFO | alignment_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/alignment_single_number_scale10.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:12, 12.63s/it]Evaluating RM: : 2it [00:33, 17.50s/it]Evaluating RM: : 3it [00:49, 17.00s/it]Evaluating RM: : 4it [01:04, 16.20s/it]2024-05-30 22:54:35 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 4
Evaluating RM: : 5it [01:20, 15.86s/it]Evaluating RM: : 6it [01:30, 14.05s/it]Evaluating RM: : 7it [01:40, 12.73s/it]Evaluating RM: : 8it [02:04, 16.19s/it]Evaluating RM: : 9it [02:15, 14.52s/it]Evaluating RM: : 10it [02:30, 14.71s/it]Evaluating RM: : 11it [02:40, 13.22s/it]Evaluating RM: : 12it [02:52, 12.95s/it]Evaluating RM: : 13it [03:06, 13.35s/it]Evaluating RM: : 14it [03:21, 13.72s/it]Evaluating RM: : 15it [03:29, 12.01s/it]Evaluating RM: : 16it [03:48, 14.28s/it]Evaluating RM: : 17it [04:11, 16.63s/it]Evaluating RM: : 18it [04:26, 16.43s/it]Evaluating RM: : 19it [04:37, 14.57s/it]Evaluating RM: : 20it [04:47, 13.28s/it]Evaluating RM: : 21it [04:57, 12.43s/it]Evaluating RM: : 22it [05:14, 13.65s/it]Evaluating RM: : 23it [05:25, 12.86s/it]Evaluating RM: : 24it [05:36, 12.46s/it]Evaluating RM: : 25it [05:52, 13.29s/it]Evaluating RM: : 26it [06:02, 12.28s/it]Evaluating RM: : 27it [06:15, 12.72s/it]Evaluating RM: : 28it [06:30, 13.23s/it]Evaluating RM: : 29it [06:46, 13.98s/it]Evaluating RM: : 30it [07:13, 18.15s/it]Evaluating RM: : 31it [07:27, 16.90s/it]Evaluating RM: : 32it [07:39, 15.28s/it]2024-05-30 23:01:27 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 32
Evaluating RM: : 33it [08:12, 20.62s/it]2024-05-30 23:01:51 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 33
Evaluating RM: : 34it [08:36, 21.52s/it]Evaluating RM: : 35it [08:58, 21.74s/it]Evaluating RM: : 36it [09:18, 21.22s/it]Evaluating RM: : 37it [09:35, 20.07s/it]Evaluating RM: : 38it [09:49, 18.08s/it]Evaluating RM: : 39it [10:04, 17.38s/it]Evaluating RM: : 40it [10:22, 17.32s/it]2024-05-30 23:04:03 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 40
Evaluating RM: : 41it [10:48, 19.97s/it]Evaluating RM: : 42it [10:58, 17.19s/it]Evaluating RM: : 43it [11:13, 16.32s/it]Evaluating RM: : 44it [11:24, 14.69s/it]2024-05-30 23:04:53 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 44
Evaluating RM: : 45it [11:38, 14.47s/it]Evaluating RM: : 46it [11:52, 14.52s/it]Evaluating RM: : 47it [12:03, 13.54s/it]Evaluating RM: : 48it [12:24, 15.54s/it]Evaluating RM: : 49it [12:36, 14.72s/it]Evaluating RM: : 50it [12:59, 16.96s/it]2024-05-30 23:06:31 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 50
Evaluating RM: : 51it [13:15, 16.91s/it]Evaluating RM: : 52it [13:26, 14.88s/it]2024-05-30 23:07:02 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 52
Evaluating RM: : 53it [13:47, 16.90s/it]Evaluating RM: : 54it [14:00, 15.61s/it]Evaluating RM: : 55it [14:10, 13.90s/it]Evaluating RM: : 56it [14:25, 14.37s/it]Evaluating RM: : 57it [14:40, 14.51s/it]Evaluating RM: : 58it [14:49, 13.00s/it]Evaluating RM: : 59it [15:00, 12.27s/it]Evaluating RM: : 60it [15:07, 10.82s/it]Evaluating RM: : 61it [15:17, 10.41s/it]Evaluating RM: : 62it [15:35, 12.83s/it]Evaluating RM: : 63it [15:46, 12.17s/it]Evaluating RM: : 64it [16:01, 13.13s/it]Evaluating RM: : 65it [16:12, 12.42s/it]Evaluating RM: : 66it [16:22, 11.49s/it]Evaluating RM: : 67it [16:35, 12.03s/it]Evaluating RM: : 68it [16:45, 11.42s/it]Evaluating RM: : 69it [16:56, 11.40s/it]Evaluating RM: : 70it [17:08, 11.52s/it]Evaluating RM: : 71it [17:21, 11.87s/it]Evaluating RM: : 72it [17:32, 11.86s/it]Evaluating RM: : 73it [17:53, 14.48s/it]Evaluating RM: : 74it [18:08, 14.73s/it]Evaluating RM: : 75it [18:27, 15.87s/it]Evaluating RM: : 76it [18:50, 17.95s/it]Evaluating RM: : 77it [19:18, 21.01s/it]Evaluating RM: : 77it [19:18, 15.04s/it]
2024-05-30 23:12:33 | INFO | alignment_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/alignment/spatial
