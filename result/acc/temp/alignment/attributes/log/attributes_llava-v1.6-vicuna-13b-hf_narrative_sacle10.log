2024-05-30 18:31:54 | INFO | alignment_rm_score | Loading reward model form llava-v1.6-vicuna-13b-hf...
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
2024-05-30 18:31:57 | INFO | accelerate.utils.modeling | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.06s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:04,  1.00s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:03<00:02,  1.01it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:04<00:02,  1.01s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:05<00:01,  1.02s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.07it/s]
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
2024-05-30 18:32:04 | INFO | alignment_rm_score | Loading prompt template from /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/prompts/alignment_single_narrative_scale10.txt
Evaluating RM: : 0it [00:00, ?it/s]Evaluating RM: : 1it [00:17, 17.36s/it]Evaluating RM: : 2it [00:27, 13.14s/it]Evaluating RM: : 3it [00:40, 12.84s/it]Evaluating RM: : 4it [00:55, 14.06s/it]Evaluating RM: : 5it [01:05, 12.32s/it]Evaluating RM: : 6it [01:22, 13.84s/it]Evaluating RM: : 7it [01:45, 16.94s/it]Evaluating RM: : 8it [02:00, 16.52s/it]Evaluating RM: : 9it [02:18, 16.92s/it]Evaluating RM: : 10it [02:35, 16.80s/it]Evaluating RM: : 11it [02:46, 15.11s/it]Evaluating RM: : 12it [03:00, 14.83s/it]Evaluating RM: : 13it [03:14, 14.56s/it]Evaluating RM: : 14it [03:29, 14.51s/it]Evaluating RM: : 15it [03:40, 13.59s/it]Evaluating RM: : 16it [03:53, 13.38s/it]Evaluating RM: : 17it [04:06, 13.17s/it]Evaluating RM: : 18it [04:22, 14.18s/it]Evaluating RM: : 19it [04:45, 16.73s/it]Evaluating RM: : 20it [04:58, 15.65s/it]Evaluating RM: : 21it [05:17, 16.54s/it]Evaluating RM: : 22it [05:31, 15.98s/it]Evaluating RM: : 23it [05:44, 14.92s/it]Evaluating RM: : 24it [05:55, 13.73s/it]Evaluating RM: : 25it [06:08, 13.58s/it]Evaluating RM: : 26it [06:18, 12.42s/it]Evaluating RM: : 27it [06:28, 11.92s/it]Evaluating RM: : 28it [06:37, 11.07s/it]Evaluating RM: : 29it [06:49, 11.31s/it]Evaluating RM: : 30it [07:04, 12.41s/it]Evaluating RM: : 31it [07:26, 15.06s/it]Evaluating RM: : 32it [07:53, 18.73s/it]Evaluating RM: : 33it [08:10, 18.39s/it]Evaluating RM: : 34it [08:20, 15.89s/it]Evaluating RM: : 35it [08:37, 16.10s/it]Evaluating RM: : 36it [08:47, 14.22s/it]Evaluating RM: : 37it [09:13, 17.71s/it]Evaluating RM: : 38it [09:25, 16.11s/it]Evaluating RM: : 39it [09:31, 13.12s/it]Evaluating RM: : 40it [09:52, 15.34s/it]Evaluating RM: : 41it [10:01, 13.41s/it]Evaluating RM: : 42it [10:16, 13.97s/it]Evaluating RM: : 43it [10:32, 14.62s/it]Evaluating RM: : 44it [10:49, 15.29s/it]Evaluating RM: : 45it [10:59, 13.73s/it]Evaluating RM: : 46it [11:16, 14.56s/it]Evaluating RM: : 47it [11:31, 14.77s/it]Evaluating RM: : 48it [11:53, 17.09s/it]Evaluating RM: : 49it [12:01, 14.38s/it]Evaluating RM: : 50it [12:11, 12.83s/it]Evaluating RM: : 51it [12:22, 12.49s/it]Evaluating RM: : 52it [12:34, 12.26s/it]Evaluating RM: : 53it [12:45, 12.00s/it]Evaluating RM: : 54it [12:59, 12.46s/it]Evaluating RM: : 55it [13:11, 12.43s/it]Evaluating RM: : 56it [13:24, 12.49s/it]Evaluating RM: : 57it [13:33, 11.51s/it]Evaluating RM: : 58it [13:37,  9.25s/it]Evaluating RM: : 59it [13:53, 11.25s/it]Evaluating RM: : 60it [14:03, 10.99s/it]Evaluating RM: : 61it [14:16, 11.59s/it]Evaluating RM: : 62it [14:43, 16.11s/it]Evaluating RM: : 63it [14:53, 14.36s/it]Evaluating RM: : 64it [15:20, 18.20s/it]Evaluating RM: : 65it [15:39, 18.21s/it]Evaluating RM: : 66it [15:58, 18.53s/it]Evaluating RM: : 67it [16:14, 17.81s/it]Evaluating RM: : 68it [16:26, 16.08s/it]Evaluating RM: : 69it [16:41, 15.59s/it]Evaluating RM: : 70it [16:50, 13.78s/it]Evaluating RM: : 71it [17:15, 17.24s/it]Evaluating RM: : 72it [17:28, 15.75s/it]2024-05-30 18:49:55 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 72
Evaluating RM: : 73it [17:51, 18.00s/it]Evaluating RM: : 74it [17:59, 14.98s/it]2024-05-30 18:50:27 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 74
Evaluating RM: : 75it [18:23, 17.64s/it]Evaluating RM: : 76it [18:42, 18.18s/it]Evaluating RM: : 77it [19:05, 19.42s/it]Evaluating RM: : 78it [19:16, 17.05s/it]Evaluating RM: : 79it [19:32, 16.68s/it]Evaluating RM: : 80it [19:41, 14.50s/it]Evaluating RM: : 81it [20:01, 16.15s/it]Evaluating RM: : 82it [20:12, 14.53s/it]Evaluating RM: : 83it [20:19, 12.29s/it]Evaluating RM: : 84it [20:30, 11.92s/it]Evaluating RM: : 85it [20:43, 12.09s/it]Evaluating RM: : 86it [21:03, 14.53s/it]Evaluating RM: : 87it [21:11, 12.69s/it]2024-05-30 18:53:50 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 87
Evaluating RM: : 88it [21:46, 19.27s/it]Evaluating RM: : 89it [22:02, 18.20s/it]Evaluating RM: : 90it [22:13, 16.21s/it]Evaluating RM: : 91it [22:24, 14.45s/it]Evaluating RM: : 92it [22:37, 14.22s/it]Evaluating RM: : 93it [23:03, 17.58s/it]Evaluating RM: : 94it [23:20, 17.53s/it]Evaluating RM: : 95it [23:33, 16.10s/it]Evaluating RM: : 96it [23:43, 14.36s/it]Evaluating RM: : 97it [23:57, 14.18s/it]Evaluating RM: : 98it [24:19, 16.61s/it]2024-05-30 18:56:45 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 98
Evaluating RM: : 99it [24:41, 18.23s/it]Evaluating RM: : 100it [24:50, 15.45s/it]Evaluating RM: : 101it [25:09, 16.62s/it]Evaluating RM: : 102it [25:25, 16.32s/it]Evaluating RM: : 103it [25:36, 14.62s/it]Evaluating RM: : 104it [25:53, 15.43s/it]Evaluating RM: : 105it [26:07, 14.88s/it]Evaluating RM: : 106it [26:18, 13.92s/it]Evaluating RM: : 107it [26:40, 16.39s/it]Evaluating RM: : 108it [27:01, 17.59s/it]2024-05-30 18:59:19 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 108
Evaluating RM: : 109it [27:15, 16.52s/it]Evaluating RM: : 110it [27:31, 16.31s/it]2024-05-30 18:59:58 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 110
Evaluating RM: : 111it [27:54, 18.46s/it]2024-05-30 19:00:17 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 111
Evaluating RM: : 112it [28:13, 18.49s/it]Evaluating RM: : 113it [28:29, 17.79s/it]Evaluating RM: : 114it [28:52, 19.27s/it]Evaluating RM: : 115it [29:05, 17.51s/it]Evaluating RM: : 116it [29:26, 18.65s/it]Evaluating RM: : 117it [29:42, 17.78s/it]2024-05-30 19:02:14 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 117
Evaluating RM: : 118it [30:10, 20.67s/it]Evaluating RM: : 119it [30:21, 17.91s/it]Evaluating RM: : 120it [30:33, 16.14s/it]Evaluating RM: : 121it [30:51, 16.56s/it]Evaluating RM: : 122it [31:09, 17.27s/it]Evaluating RM: : 123it [31:38, 20.52s/it]Evaluating RM: : 124it [31:55, 19.68s/it]Evaluating RM: : 125it [32:17, 20.43s/it]Evaluating RM: : 126it [32:29, 17.68s/it]2024-05-30 19:04:48 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 126
Evaluating RM: : 127it [32:44, 16.92s/it]2024-05-30 19:05:25 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 127
Evaluating RM: : 128it [33:20, 22.80s/it]Evaluating RM: : 129it [33:39, 21.51s/it]Evaluating RM: : 130it [33:50, 18.27s/it]Evaluating RM: : 131it [34:00, 15.80s/it]2024-05-30 19:06:19 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 131
Evaluating RM: : 132it [34:15, 15.69s/it]Evaluating RM: : 133it [34:26, 14.29s/it]Evaluating RM: : 134it [34:45, 15.74s/it]Evaluating RM: : 135it [34:55, 13.97s/it]Evaluating RM: : 136it [35:06, 13.15s/it]Evaluating RM: : 137it [35:16, 12.08s/it]2024-05-30 19:07:51 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 137
Evaluating RM: : 138it [35:46, 17.64s/it]Evaluating RM: : 139it [35:57, 15.51s/it]Evaluating RM: : 140it [36:02, 12.47s/it]Evaluating RM: : 141it [36:17, 12.98s/it]Evaluating RM: : 142it [36:33, 14.04s/it]Evaluating RM: : 143it [36:48, 14.40s/it]Evaluating RM: : 144it [37:09, 16.16s/it]Evaluating RM: : 145it [37:25, 16.34s/it]Evaluating RM: : 146it [37:37, 14.88s/it]Evaluating RM: : 147it [37:47, 13.50s/it]Evaluating RM: : 148it [38:00, 13.44s/it]Evaluating RM: : 149it [38:17, 14.35s/it]Evaluating RM: : 150it [38:32, 14.69s/it]Evaluating RM: : 151it [38:47, 14.54s/it]Evaluating RM: : 152it [39:04, 15.48s/it]Evaluating RM: : 153it [39:21, 15.81s/it]Evaluating RM: : 154it [39:32, 14.37s/it]Evaluating RM: : 155it [39:42, 13.16s/it]Evaluating RM: : 156it [39:53, 12.49s/it]Evaluating RM: : 157it [40:08, 13.25s/it]Evaluating RM: : 158it [40:28, 15.32s/it]Evaluating RM: : 159it [40:44, 15.45s/it]Evaluating RM: : 160it [41:07, 17.71s/it]Evaluating RM: : 161it [41:18, 15.74s/it]Evaluating RM: : 162it [41:30, 14.54s/it]Evaluating RM: : 163it [41:40, 13.08s/it]Evaluating RM: : 164it [41:53, 13.21s/it]Evaluating RM: : 165it [42:06, 13.15s/it]Evaluating RM: : 166it [42:19, 12.99s/it]Evaluating RM: : 167it [42:30, 12.45s/it]Evaluating RM: : 168it [42:41, 12.09s/it]Evaluating RM: : 169it [42:53, 12.06s/it]Evaluating RM: : 170it [43:10, 13.62s/it]Evaluating RM: : 171it [43:19, 12.01s/it]Evaluating RM: : 172it [43:29, 11.59s/it]Evaluating RM: : 173it [43:38, 10.82s/it]Evaluating RM: : 174it [43:49, 10.82s/it]Evaluating RM: : 175it [44:01, 11.27s/it]Evaluating RM: : 176it [44:24, 14.56s/it]Evaluating RM: : 177it [44:37, 14.08s/it]Evaluating RM: : 178it [44:50, 13.90s/it]Evaluating RM: : 179it [45:06, 14.37s/it]Evaluating RM: : 180it [45:23, 15.24s/it]Evaluating RM: : 181it [45:34, 14.03s/it]Evaluating RM: : 182it [45:46, 13.27s/it]Evaluating RM: : 183it [46:02, 14.27s/it]Evaluating RM: : 184it [46:13, 13.29s/it]Evaluating RM: : 185it [46:29, 14.08s/it]Evaluating RM: : 186it [46:48, 15.52s/it]Evaluating RM: : 187it [47:03, 15.32s/it]Evaluating RM: : 188it [47:11, 13.23s/it]Evaluating RM: : 189it [47:29, 14.56s/it]Evaluating RM: : 190it [47:40, 13.49s/it]Evaluating RM: : 191it [47:50, 12.45s/it]Evaluating RM: : 192it [47:58, 11.16s/it]Evaluating RM: : 193it [48:10, 11.49s/it]Evaluating RM: : 194it [48:32, 14.63s/it]Evaluating RM: : 195it [48:39, 12.33s/it]Evaluating RM: : 196it [48:54, 13.19s/it]Evaluating RM: : 197it [49:06, 12.83s/it]Evaluating RM: : 198it [49:20, 12.95s/it]Evaluating RM: : 199it [49:36, 13.91s/it]Evaluating RM: : 200it [49:56, 15.76s/it]Evaluating RM: : 201it [50:06, 14.03s/it]Evaluating RM: : 202it [50:20, 14.22s/it]Evaluating RM: : 203it [50:31, 13.13s/it]Evaluating RM: : 204it [50:41, 12.23s/it]Evaluating RM: : 205it [50:56, 12.96s/it]2024-05-30 19:23:29 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 205
Evaluating RM: : 206it [51:24, 17.64s/it]Evaluating RM: : 207it [51:36, 15.87s/it]2024-05-30 19:23:54 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 207
Evaluating RM: : 208it [51:49, 15.06s/it]Evaluating RM: : 209it [52:11, 16.96s/it]Evaluating RM: : 210it [52:22, 15.39s/it]Evaluating RM: : 211it [52:39, 15.78s/it]Evaluating RM: : 212it [52:57, 16.54s/it]Evaluating RM: : 213it [53:08, 14.81s/it]Evaluating RM: : 214it [53:15, 12.30s/it]Evaluating RM: : 215it [53:30, 13.18s/it]Evaluating RM: : 216it [53:56, 17.14s/it]Evaluating RM: : 217it [54:16, 17.80s/it]Evaluating RM: : 218it [54:23, 14.70s/it]Evaluating RM: : 219it [54:33, 13.19s/it]Evaluating RM: : 220it [54:44, 12.64s/it]Evaluating RM: : 221it [55:05, 14.97s/it]Evaluating RM: : 222it [55:18, 14.65s/it]Evaluating RM: : 223it [55:35, 15.20s/it]2024-05-30 19:27:55 | INFO | alignment_rm_score | Cannot parsing the score from vlm output. sample id is 223
Evaluating RM: : 224it [55:50, 15.25s/it]Evaluating RM: : 225it [56:00, 13.68s/it]Evaluating RM: : 226it [56:30, 18.55s/it]Evaluating RM: : 227it [56:40, 15.84s/it]Evaluating RM: : 228it [56:52, 14.78s/it]Evaluating RM: : 229it [56:57, 11.78s/it]Evaluating RM: : 230it [57:13, 13.21s/it]Evaluating RM: : 230it [57:13, 14.93s/it]
2024-05-30 19:29:18 | INFO | alignment_rm_score | Saving result to /cpfs01/user/duyichao/workspace/LLM_RLAIF/MM-Reward/eval/results/alignment/attributes
